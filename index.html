<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Terraria Clone - Re-Logic Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', Courier, monospace; color: white; }
        canvas { display: block; image-rendering: pixelated; }
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .menu-screen { 
            position: absolute; width: 100%; height: 100%; 
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: rgba(0,0,0,0.7); pointer-events: auto;
        }
        .btn {
            background: #444; border: 2px solid #888; padding: 15px 40px; margin: 10px;
            cursor: pointer; font-size: 20px; transition: 0.2s;
        }
        .btn:hover { background: #666; border-color: #fff; }
        #splash { background: #000; z-index: 100; }
        #main-menu { display: none; background: url('https://i.imgur.com/39p6m9V.png') center/cover; }
    </style>
</head>
<body>

<div id="ui-layer">
    <div id="splash" class="menu-screen">
        <h1 id="relogic-text" style="font-size: 60px; letter-spacing: 10px;">RE-LOGIC</h1>
        <p id="relogic-sub">Development and Strategy</p>
    </div>

    <div id="main-menu" class="menu-screen">
        <h1 style="font-size: 80px; text-shadow: 4px 4px #000;">TERRARIA</h1>
        <div class="btn" onclick="startGame()">Single Player</div>
        <div class="btn" onclick="alert('Multiplayer coming soon!')">Multiplayer</div>
        <div class="btn">Settings</div>
        <div class="btn" onclick="window.close()">Exit</div>
    </div>

    <div id="hud" style="display:none; padding: 20px;">
        HP: <div style="width:200px; height:20px; background:#555; border:2px solid #fff;">
            <div id="hp-fill" style="width:100%; height:100%; background:red;"></div>
        </div>
    </div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let gameState = "SPLASH";

// --- SPLASH SCREEN LOGIC ---
function initSplash() {
    const text = document.getElementById('relogic-text');
    const bg = document.getElementById('splash');
    const variations = [
        { t: "RE-LOGIC", c: "#32CD32", b: "#000" }, // Classic Green
        { t: "RE-LOGIC", c: "#FFF", b: "#2c3e50" },    // Modern White
        { t: "RE-LOGIC", c: "#da70d6", b: "#1a0521" }  // Purple/Corruption
    ];
    const rand = variations[Math.floor(Math.random() * variations.length)];
    text.style.color = rand.c;
    bg.style.backgroundColor = rand.b;

    // Fade out splash after 2.5 seconds
    setTimeout(() => {
        document.getElementById('splash').style.display = 'none';
        document.getElementById('main-menu').style.display = 'flex';
        gameState = "MENU";
    }, 2500);
}

// --- GAME CORE ---
const TILE_SIZE = 16;
const WORLD_W = 300;
const WORLD_H = 150;
let world = [];
let camera = { x: 0, y: 0 };
let player = { x: 2400, y: 500, vx: 0, vy: 0, w: 16, h: 30, grounded: false };

function startGame() {
    document.getElementById('main-menu').style.display = 'none';
    document.getElementById('hud').style.display = 'block';
    gameState = "PLAYING";
    initWorld();
}

function initWorld() {
    for (let x = 0; x < WORLD_W; x++) {
        world[x] = [];
        let surface = Math.floor(60 + Math.sin(x * 0.1) * 8);
        for (let y = 0; y < WORLD_H; y++) {
            if (y < surface) world[x][y] = 0;
            else if (y === surface) world[x][y] = 2; // Grass
            else world[x][y] = 1; // Dirt
        }
    }
}

function update() {
    if (gameState !== "PLAYING") return;

    if (keys['a']) player.vx -= 0.5;
    if (keys['d']) player.vx += 0.5;
    if (keys[' '] && player.grounded) { player.vy = -7; player.grounded = false; }

    player.vy += 0.3; // Gravity
    player.vx *= 0.8; // Friction

    // Physics
    player.x += player.vx;
    if (isSolid(player.x, player.y + 5) || isSolid(player.x + player.w, player.y + 5)) {
        player.x -= player.vx; player.vx = 0;
    }
    player.y += player.vy;
    player.grounded = false;
    if (isSolid(player.x, player.y + player.h) || isSolid(player.x + player.w, player.y + player.h)) {
        player.y -= player.vy; player.vy = 0; player.grounded = true;
    }

    camera.x += (player.x - window.innerWidth/2 - camera.x) * 0.1;
    camera.y += (player.y - window.innerHeight/2 - camera.y) * 0.1;
}

function isSolid(x, y) {
    let tx = Math.floor(x / TILE_SIZE);
    let ty = Math.floor(y / TILE_SIZE);
    return world[tx] && world[tx][ty] !== 0;
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (gameState !== "PLAYING") return;

    ctx.fillStyle = '#87CEEB'; // Sky
    ctx.fillRect(0,0, canvas.width, canvas.height);

    for(let x = Math.floor(camera.x/16); x < Math.floor((camera.x + canvas.width)/16) + 1; x++) {
        for(let y = Math.floor(camera.y/16); y < Math.floor((camera.y + canvas.height)/16) + 1; y++) {
            if(!world[x] || world[x][y] === 0) continue;
            ctx.fillStyle = world[x][y] === 2 ? '#4caf50' : '#5d4037';
            ctx.fillRect(x*16 - camera.x, y*16 - camera.y, 16, 16);
        }
    }

    ctx.fillStyle = 'red';
    ctx.fillRect(player.x - camera.x, player.y - camera.y, player.w, player.h);
}

// --- UTILS ---
const keys = {};
window.onkeydown = e => keys[e.key.toLowerCase()] = true;
window.onkeyup = e => keys[e.key.toLowerCase()] = false;

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
initSplash();
loop();
</script>
</body>
</html>
