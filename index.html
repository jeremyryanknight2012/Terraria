<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Terraria - Full GitHub Build</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial', sans-serif; color: white; user-select: none; }
        canvas { display: block; image-rendering: pixelated; }
        
        /* UI Layers */
        .screen { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #000; transition: opacity 0.8s; z-index: 20; }
        .hidden { display: none !important; }
        
        /* Menu Visuals */
        #screen-menu { background: #000; overflow: hidden; }
        .menu-bg-layer { position: absolute; width: 110%; height: 110%; top: -5%; left: -5%; object-fit: cover; z-index: -1; }
        
        .btn { 
            background: rgba(35, 40, 90, 0.85); border: 2px solid #6b7aff; 
            padding: 15px 50px; margin: 10px; cursor: pointer; font-size: 24px;
            text-shadow: 2px 2px #000; width: 300px; text-align: center;
            transition: 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        .btn:hover { background: #4a54d1; border-color: #fff; transform: scale(1.05); }

        #hud { position: absolute; top: 20px; left: 20px; pointer-events: none; display: none; z-index: 10; }
        .hotbar { display: flex; gap: 8px; }
        .slot { width: 48px; height: 48px; background: rgba(0,0,0,0.7); border: 2px solid #aaa; display: flex; align-items: center; justify-content: center; font-size: 20px; }
        .selected { border-color: #ffd700; box-shadow: 0 0 15px #ffd700; }
    </style>
</head>
<body>

    <div id="screen-splash" class="screen">
        <img id="splash-img" src="" style="width: 500px; filter: drop-shadow(0 0 30px rgba(255,255,255,0.1));">
    </div>

    <div id="screen-menu" class="screen hidden">
        <img src="https://jeremyryanknight2012.github.io/Terraria/thumbnails/bg_0.png" class="menu-bg-layer" style="opacity: 1;">
        <img src="https://jeremyryanknight2012.github.io/Terraria/thumbnails/bg_1.png" class="menu-bg-layer" id="cloud-layer" style="opacity: 0.8;">
        <img src="https://jeremyryanknight2012.github.io/Terraria/thumbnails/bg_2.png" class="menu-bg-layer" style="opacity: 0.9;">
        
        <h1 style="font-size: 90px; margin-bottom: 40px; text-shadow: 6px 6px #000; color: #a2ffaf; letter-spacing: 5px;">Terraria</h1>
        
        <div class="btn" onclick="showScreen('screen-world')">Single Player</div>
        <div class="btn" onclick="alert('Join via Steam...')">Multiplayer</div>
        <div class="btn" onclick="location.reload()">Refresh Assets</div>
        <div class="btn" onclick="window.close()">Exit Game</div>
    </div>

    <div id="screen-world" class="screen hidden">
        <h2 style="font-size: 32px; margin-bottom: 30px;">Choose World</h2>
        <div class="btn" style="width: 450px; height: 80px; text-align: left; display: flex; align-items: center;" onclick="initGame('Small')">
            <div style="font-size: 30px; margin-right: 20px;">üå≥</div>
            <div><b>World 1</b><br><span style="font-size: 14px; color: #ccc;">Small World - Journey Mode</span></div>
        </div>
        <div class="btn" style="background: #1b5e20; width: 450px;" onclick="initGame('Large')">Create New World</div>
        <div class="btn" onclick="showScreen('screen-menu')">Back</div>
    </div>

    <div id="hud">
        <div class="hotbar">
            <div class="slot selected">‚õèÔ∏è</div>
            <div class="slot">üó°Ô∏è</div>
            <div class="slot">üß±</div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
/**
 * TERRARIA ULTIMATE REPLICA - GITHUB REPO INTEGRATED
 */

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const ASSET_BASE = "https://jeremyryanknight2012.github.io/Terraria/thumbnails/";

const assets = {};
let gameActive = false;
let worldData = [];
let camera = { x: 0, y: 0 };
let player = { x: 0, y: 0, vx: 0, vy: 0, w: 20, h: 34, grounded: false };
const keys = {};
const mouse = { x: 0, y: 0, down: false };

// --- ASSET LOADER ---
function loadAssets(callback) {
    const images = {
        relogic1: 'relogic1.png',
        relogic2: 'relogic2.png',
        relogic3: 'relogic3.png',
        relogic4: 'relogic4.png',
        relogic5: 'relogic5.png',
        relogic6: 'relogic6.png',
        relogic7: 'relogic7.png',
        relogic8: 'relogic8.png',
        relogic9: 'relogic9.png',
        relogic10: 'relogic10.png',
        tile1: 'tile1.png',
        tile2: 'tile2.png',
        tile3: 'tile3.png',
        player: 'player_idle.png'
    };
    
    let loaded = 0;
    const total = Object.keys(images).length;
    for (let key in images) {
        assets[key] = new Image();
        assets[key].crossOrigin = "anonymous";
        assets[key].src = ASSET_BASE + images[key];
        assets[key].onload = () => { if (++loaded === total) callback(); };
        assets[key].onerror = () => { if (++loaded === total) callback(); };
    }
}

function showScreen(id) {
    document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
    if(id !== 'none') document.getElementById(id).classList.remove('hidden');
}

// --- INITIALIZE SPLASH (3 VARIATIONS) ---
function startSequence() {
    const splashImg = document.getElementById('splash-img');
    const splashes = [assets.relogic1, assets.relogic2, assets.relogic3];
    // Randomly pick 1 of the 3 links
    splashImg.src = splashes[Math.floor(Math.random() * splashes.length)].src;

    setTimeout(() => {
        document.getElementById('screen-splash').style.opacity = '0';
        setTimeout(() => showScreen('screen-menu'), 800);
    }, 3000);
}

// --- WORLD LOGIC ---
function initGame(size) {
    showScreen('none');
    document.getElementById('hud').style.display = 'block';
    
    const width = size === 'Large' ? 1500 : 800;
    const height = 400;
    
    for(let x=0; x < width; x++) {
        worldData[x] = [];
        let surface = Math.floor(100 + Math.sin(x * 0.08) * 8);
        for(let y=0; y < height; y++) {
            if(y < surface) worldData[x][y] = 0;
            else if(y === surface) worldData[x][y] = 2; // Grass
            else if(y < surface + 10) worldData[x][y] = 1; // Dirt
            else worldData[x][y] = 3; // Stone
        }
    }
    
    player.x = (width * 16) / 2;
    player.y = 80 * 16;
    gameActive = true;
}

function update() {
    if(!gameActive) return;
    
    if(keys['a']) player.vx -= 0.6;
    if(keys['d']) player.vx += 0.6;
    if((keys['w'] || keys[' ']) && player.grounded) { player.vy = -8; player.grounded = false; }
    
    player.vy += 0.4;
    player.vx *= 0.85;
    
    player.x += player.vx;
    player.y += player.vy;

    // Floor Collision Check
    let tx = Math.floor((player.x + player.w/2) / 16);
    let ty = Math.floor((player.y + player.h) / 16);
    if(worldData[tx] && worldData[tx][ty] !== 0) {
        player.y = ty * 16 - player.h;
        player.vy = 0;
        player.grounded = true;
    }

    camera.x += (player.x - canvas.width/2 - camera.x) * 0.1;
    camera.y += (player.y - canvas.height/2 - camera.y) * 0.1;

    // Mining Interaction
    if(mouse.down) {
        let mx = Math.floor((mouse.x + camera.x) / 16);
        let my = Math.floor((mouse.y + camera.y) / 16);
        if(worldData[mx]) worldData[mx][my] = 0;
    }
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if(!gameActive) return;

    // Sky Color (Changes with Depth)
    ctx.fillStyle = player.y > 1800 ? '#111' : '#5db1ff';
    ctx.fillRect(0,0, canvas.width, canvas.height);

    const sX = Math.floor(camera.x / 16);
    const eX = sX + Math.ceil(canvas.width / 16) + 1;
    const sY = Math.floor(camera.y / 16);
    const eY = sY + Math.ceil(canvas.height / 16) + 1;

    for(let x=sX; x<eX; x++) {
        if(!worldData[x]) continue;
        for(let y=sY; y<eY; y++) {
            let id = worldData[x][y];
            if(id === 0) continue;
            let img = assets['tile' + id];
            if(img && img.complete) {
                ctx.drawImage(img, x*16 - camera.x, y*16 - camera.y, 16, 16);
            }
        }
    }

    // Player Rendering
    if(assets.player.complete) {
        ctx.drawImage(assets.player, player.x - camera.x, player.y - camera.y, player.w, player.h);
    } else {
        ctx.fillStyle = '#ff7777';
        ctx.fillRect(player.x - camera.x, player.y - camera.y, player.w, player.h);
    }
}

// --- INPUTS ---
window.onkeydown = e => keys[e.key.toLowerCase()] = true;
window.onkeyup = e => keys[e.key.toLowerCase()] = false;
window.onmousedown = () => mouse.down = true;
window.onmouseup = () => mouse.down = false;
window.onmousemove = e => { mouse.x = e.clientX; mouse.y = e.clientY; };

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

// Final Init
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
loadAssets(() => {
    startSequence();
    gameLoop();
});

</script>
</body>
</html>
